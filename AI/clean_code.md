# Правила чистого кода для ИИ

## Основные правила

*   **Правило:** Вся бизнес-логика должна быть вынесена из контроллеров в **Actions** (для простых атомарных операций) или **Services** (для сложных многошаговых процессов). Контроллеры должны быть "тонкими".
*   **Правило:** Для предотвращения проблемы "N+1" всегда используй "жадную загрузку" (`with()`) при получении моделей с их отношениями в циклах или при сериализации.
*   **Правило:** Для защиты от уязвимостей Mass Assignment всегда используй свойство `$fillable` или `$guarded` в моделях Eloquent.
*   **Правило:** В коде приложения всегда используй хелпер `config()` для доступа к переменным окружения. Хелпер `env()` разрешено использовать только внутри конфигурационных файлов (`config/*.php`).
*   **Правило:** Избегай вложенности с помощью `else`. Вместо этого применяй **ранние возвраты** (Early Returns).
*   **Правило:** Не дублируй код (принцип DRY). Используй следующие инструменты:
    *   **Компоненты Blade** для повторяющегося HTML.
    *   **Query Scopes** для повторяющихся запросов Eloquent.
    *   **Form Requests** для валидации.
    *   **Actions/Services** для общей бизнес-логики.
*   **Правило:** Предпочитай использовать **Коллекции Laravel** вместо нативных массивов для обработки данных.
*   **Правило:** Не размещай бизнес-логику, вычисления или запросы к БД в файлах Blade. Представления должны только отображать уже подготовленные данные. Используй `Attributes` в моделях (`getFullNameAttribute`) для простой логики форматирования.
*   **Правило:** Запрещено использовать статические методы для бизнес-логики. Разрешено только для stateless-хелперов и фабричных методов (например, `DTO::fromRequest()`).
