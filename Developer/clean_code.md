# Принципы чистого кода

## Введение

Чистый код — это код, который легко читать, понимать и поддерживать. Он написан так, будто это проза, предназначенная для людей, а не только для машин. Цель этого документа — предоставить практические советы, которые помогут сделать ваш код более качественным.

## Последовательность и форматирование

Единообразие стиля — ключ к читаемости. Когда весь код в проекте выглядит так, будто его написал один человек, новым разработчикам гораздо проще в нём ориентироваться.

*   **Следуйте стандарту [PER](https://www.php-fig.org/per/coding-style/)**. Он объединяет лучшие практики из PSR-1, PSR-2 и PSR-12.
*   **Используйте автоматические инструменты** для форматирования, такие как **Laravel Pint** или **PHP-CS-Fixer**. Это избавит от споров о стиле и обеспечит его соблюдение.

### Пример

```php
// ❌ Плохо: отсутствует единый стиль
class ChirpController extends Controller {
  public  function index (){
        $chirps = Chirp::with('user')->latest()->get();
        return view('chirps.index',[
'chirps' => $chirps]);
    }
}

// ✅ Хорошо: последовательное форматирование
class ChirpController extends Controller
{
    public function index()
    {
        $chirps = Chirp::with('user')->latest()->get();

        return view('chirps.index', [
            'chirps' => $chirps,
        ]);
    }
}
```

## Избегайте "магических чисел"

"Магические числа" — это числовые литералы, используемые в коде без объяснения их смысла. Они усложняют понимание и поддержку.

Вместо них используйте **именованные константы** или **перечисления (Enums)**.

### Пример

```php
// ❌ Плохо: что означает `1`?
if ($status == 1) {
    // ...
}

// ✅ Хорошо: использование константы
const STATUS_ACTIVE = 1;

if ($status === STATUS_ACTIVE) {
    // ...
}

// ✅ Отлично: использование перечисления (Enum)
enum Status: int
{
    case ACTIVE = 1;
    case INACTIVE = 2;
    case ARCHIVED = 3;
}

if ($status === Status::ACTIVE) {
    // ...
}
```

## Избегайте использования `else`

Глубокая вложенность условий делает код трудным для восприятия. Старайтесь минимизировать использование `else`, применяя **ранние возвраты (early returns)**.

### Пример

```php
// ❌ Плохо: глубокая вложенность
public function isUserAllowedToAccess(User $user): bool {
    if (!$user->isBanned()) {
        if ($user->isAdmin() || $user->isGranted(GRANT::EDIT)) {
            return true;
        } else {
            return false;
        }
    } else {
        return false;
    }
}

// ✅ Хорошо: ранние возвраты
public function isUserAllowedToAccess(User $user): bool
{
    if ($user->isBanned()) {
        return false;
    }

    if ($user->isAdmin() || $user->isGranted(GRANT::EDIT)) {
        return true;
    }

    return false;
}
```

## "Счастливый путь" (Happy Path)

Этот принцип гласит, что основной, позитивный сценарий выполнения функции должен быть на верхнем уровне вложенности. Все проверки, исключения и пограничные случаи должны обрабатываться в самом начале.

Это делает код более читаемым, так как основная логика не "тонет" внутри условных блоков.

### Пример

```php
// ❌ Плохо: основная логика внутри условия
public function processFile(string $path): void
{
    if (file_exists($path)) {
        // ...
        // Много строк основной логики
        // ...
    } else {
        throw new FileNotFoundException();
    }
}

// ✅ Хорошо: сначала обработка ошибки
public function processFile(string $path): void
{
    if (!file_exists($path)) {
        throw new FileNotFoundException();
    }

    // ...
    // Основная логика здесь, без лишней вложенности
    // ...
}
```

## Резюме

*   **Пишите код для людей.** Он должен быть понятен без дополнительных объяснений.
*   **Соблюдайте единый стиль.** Автоматизируйте этот процесс.
*   **Избавляйтесь от "магических" значений.** Используйте константы и перечисления.
*   **Уменьшайте вложенность.** Применяйте ранние возвраты.
*   **Следуйте принципу "счастливого пути"**.
